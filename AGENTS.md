# Repository Guidelines

## Project Structure & Module Organization
- `src/` — TypeScript source for the CLI (`src/cli`), core logic (`src/core`), services, utils, and types.
- `tests/` — Unit, integration, and edge tests; test setup in `tests/setup.ts`.
- `docs/`, `examples/`, `scripts/`, `test-fixtures/` — Supporting materials and helpers.
- `dist/` — Build output (generated by `pnpm build`).
- Config: `insight.config.json`, `vitest.config.ts`, `.eslintrc.json`, `.prettierrc`, `.env(.example)`.

## Build, Test, and Development Commands
- `pnpm install` — Install dependencies (Node ≥ 20, pnpm ≥ 8).
- `pnpm dev` — Run the CLI in dev via tsx (`src/cli/index.ts`).
- `pnpm build` — Type-check and emit JS to `dist/`.
- `pnpm test` / `pnpm test:watch` — Run tests (Vitest). `test:coverage` for coverage.
- `pnpm lint` / `pnpm lint:fix` — Lint TypeScript with ESLint.
- `pnpm format` / `pnpm format:check` — Apply/check Prettier formatting.
- `pnpm type-check` — Strict TS checks without emitting.
- `pnpm quality` — Lint + type-check + coverage; use before PRs.

## Coding Style & Naming Conventions
- Formatting via Prettier: 2 spaces, 80 cols, single quotes, semicolons, LF.
- ESLint: TypeScript rules enforced (no unused vars; prefer `const`; avoid `any`; explicit return types warned).
- Naming: files kebab-case (`my-feature.ts`); classes/interfaces PascalCase; functions/vars camelCase; tests `*.test.ts` or `*.spec.ts`.
- Use path aliases (`@/core`, `@/utils`) as configured in `vitest.config.ts`.

## Testing Guidelines
- Framework: Vitest with Node environment. Test files under `tests/**` or `src/**`.
- Coverage thresholds: global ≥ 80% lines/statements (see `vitest.config.ts` for specifics and stricter module thresholds).
- Examples: `pnpm test:unit`, `pnpm test:integration`, `pnpm test:edge`, `pnpm test:serve`.

## Commit & Pull Request Guidelines
- Use Conventional Commits (`feat:`, `fix:`, `docs:`, `refactor:`). See `git log` for examples.
- Before opening a PR: run `pnpm quality`, update docs (`README.md`, `SERVE_DEMO.md` when UI/serve changes), and add/adjust tests.
- PRs must include: clear description, linked issue(s), rationale, and screenshots/GIFs for CLI UI or `insight serve` output where relevant.

## Security & Configuration
- Do not commit secrets. Use `.env` (copy from `.env.example`) and repository config in `insight.config.json`.
